<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `oscore` mod in crate `oscore`."><meta name="keywords" content="rust, rustlang, rust-lang, oscore"><title>oscore::oscore - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css"><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="shortcut icon" href="../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../oscore/index.html'><div class='logo-container'><img src='../../rust-logo.png' alt='logo'></div></a><p class='location'>Module oscore</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#types">Type Definitions</a></li></ul></div><p class='location'><a href='../index.html'>oscore</a></p><script>window.sidebarCurrent = {name: 'oscore', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../src/oscore/oscore/mod.rs.html#1-86' title='goto source code'>[src]</a></span><span class='in-band'>Module <a href='../index.html'>oscore</a>::<wbr><a class="mod" href=''>oscore</a></span></h1><div class='docblock'><p>OSCORE implementation deriving keys from a master secret and master salt.</p>
<p>It's pretty simple to use. Both parties need to establish some information,
such as the master secret, salt and their IDs out of band (e.g. with
EDHOC). Then both can use these to derive opposite security contexts, with
which they can protect and unprotect CoAP requests and responses.</p>
<h1 id="usage" class="section-header"><a href="#usage">Usage</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">oscore</span>::<span class="ident">oscore</span>::<span class="ident">SecurityContext</span>;

<span class="comment">// This information has been established between the client and server, for</span>
<span class="comment">// example with EDHOC.</span>
<span class="kw">let</span> <span class="ident">master_secret</span> <span class="op">=</span> [
    <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>,
    <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>,
];
<span class="kw">let</span> <span class="ident">master_salt</span> <span class="op">=</span> [<span class="number">0x9E</span>, <span class="number">0x7C</span>, <span class="number">0xA9</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x78</span>, <span class="number">0x63</span>, <span class="number">0x40</span>];
<span class="kw">let</span> <span class="ident">client_id</span> <span class="op">=</span> [];
<span class="kw">let</span> <span class="ident">server_id</span> <span class="op">=</span> [<span class="number">0x01</span>];

<span class="comment">// Client -----------------------------------------------------------------</span>

<span class="comment">// Establish security context using master secret &amp; salt from EDHOC</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">client_context</span> <span class="op">=</span> <span class="ident">SecurityContext</span>::<span class="ident">new</span>(
    <span class="ident">master_secret</span>.<span class="ident">to_vec</span>(),
    <span class="ident">master_salt</span>.<span class="ident">to_vec</span>(),
    <span class="ident">client_id</span>.<span class="ident">to_vec</span>(),
    <span class="ident">server_id</span>.<span class="ident">to_vec</span>(),
)
.<span class="ident">unwrap</span>();
<span class="comment">// This is the CoAP request we want to send</span>
<span class="kw">let</span> <span class="ident">req_unprotected</span> <span class="op">=</span> [
    <span class="number">0x44</span>, <span class="number">0x01</span>, <span class="number">0x5D</span>, <span class="number">0x1F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x39</span>, <span class="number">0x74</span>, <span class="number">0x39</span>, <span class="number">0x6C</span>, <span class="number">0x6F</span>,
    <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x6C</span>, <span class="number">0x68</span>, <span class="number">0x6F</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x83</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x31</span>,
];
<span class="comment">// Protect the request</span>
<span class="kw">let</span> <span class="ident">req_protected</span> <span class="op">=</span>
    <span class="ident">client_context</span>.<span class="ident">protect_request</span>(<span class="kw-2">&amp;</span><span class="ident">req_unprotected</span>).<span class="ident">unwrap</span>();

<span class="comment">// Server -----------------------------------------------------------------</span>

<span class="comment">// Establish security context using master secret &amp; salt from EDHOC (note</span>
<span class="comment">// that server and client IDs are reversed on this side)</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">server_context</span> <span class="op">=</span> <span class="ident">SecurityContext</span>::<span class="ident">new</span>(
    <span class="ident">master_secret</span>.<span class="ident">to_vec</span>(),
    <span class="ident">master_salt</span>.<span class="ident">to_vec</span>(),
    <span class="ident">server_id</span>.<span class="ident">to_vec</span>(),
    <span class="ident">client_id</span>.<span class="ident">to_vec</span>(),
)
.<span class="ident">unwrap</span>();
<span class="comment">// Unprotect the request</span>
<span class="kw">let</span> <span class="ident">req_unprotected_local</span> <span class="op">=</span>
    <span class="ident">server_context</span>.<span class="ident">unprotect_request</span>(<span class="kw-2">&amp;</span><span class="ident">req_protected</span>).<span class="ident">unwrap</span>();
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="kw-2">&amp;</span><span class="ident">req_unprotected</span>[..], <span class="kw-2">&amp;</span><span class="ident">req_unprotected_local</span>[..]);

<span class="comment">// This is the CoAP response we want to send</span>
<span class="kw">let</span> <span class="ident">res_unprotected</span> <span class="op">=</span> [
    <span class="number">0x64</span>, <span class="number">0x45</span>, <span class="number">0x5D</span>, <span class="number">0x1F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x39</span>, <span class="number">0x74</span>, <span class="number">0xFF</span>, <span class="number">0x48</span>, <span class="number">0x65</span>,
    <span class="number">0x6C</span>, <span class="number">0x6C</span>, <span class="number">0x6F</span>, <span class="number">0x20</span>, <span class="number">0x57</span>, <span class="number">0x6F</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x64</span>, <span class="number">0x21</span>,
];
<span class="comment">// Protect the response</span>
<span class="kw">let</span> <span class="ident">res_protected</span> <span class="op">=</span> <span class="ident">server_context</span>
    .<span class="ident">protect_response</span>(<span class="kw-2">&amp;</span><span class="ident">res_unprotected</span>, <span class="kw-2">&amp;</span><span class="ident">req_protected</span>, <span class="bool-val">true</span>)
    .<span class="ident">unwrap</span>();

<span class="comment">// Client -----------------------------------------------------------------</span>

<span class="comment">// Unprotect the response</span>
<span class="kw">let</span> <span class="ident">res_unprotected_local</span> <span class="op">=</span>
    <span class="ident">client_context</span>.<span class="ident">unprotect_response</span>(<span class="kw-2">&amp;</span><span class="ident">res_protected</span>).<span class="ident">unwrap</span>();
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="kw-2">&amp;</span><span class="ident">res_unprotected</span>[..], <span class="kw-2">&amp;</span><span class="ident">res_unprotected_local</span>[..]);</pre></div>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.SecurityContext.html" title='oscore::oscore::SecurityContext struct'>SecurityContext</a></td><td class='docblock-short'><p>The security context.</p>
</td></tr></table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table><tr class='module-item'><td><a class="enum" href="enum.Error.html" title='oscore::oscore::Error enum'>Error</a></td><td class='docblock-short'><p>The catch-all error type for this module, mostly just wrapping errors from
various libraries.</p>
</td></tr></table><h2 id='types' class='section-header'><a href="#types">Type Definitions</a></h2>
<table><tr class='module-item'><td><a class="type" href="type.Result.html" title='oscore::oscore::Result type'>Result</a></td><td class='docblock-short'><p>The result type for the <code>oscore</code> module.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../../";window.currentCrate = "oscore";</script><script src="../../aliases.js"></script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>